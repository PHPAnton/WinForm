import pandas as pd
import sqlite3

excel_file = 'C:/Users/badbo/OneDrive/–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª/DemoEx/WinFormsApp1/WinFormsApp1/Vakansi.xlsx'

df = pd.read_excel(excel_file)

conn = sqlite3.connect('C:/Users/badbo/OneDrive/–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª/DemoEx/WinFormsApp1/WinFormsApp1/mydata.db')

df.to_sql('Vakansi', conn, if_exists='append', index=False)

conn.close()

print("–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω.")


update Vakansi set SpecializeId = (select Id from Specialize where Specialize.Name = Vakansi.SpecializeId);





üìÅ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—á–µ—Ä–µ–∑ NuGet CLI)
================================================================================
# –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
dotnet add package Microsoft.EntityFrameworkCore
dotnet add package Microsoft.EntityFrameworkCore.Sqlite
dotnet add package Microsoft.EntityFrameworkCore.Tools

üìÅ –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö (Entity Framework –º–æ–¥–µ–ª–∏)
================================================================================
// Models/–ú–∞—Ç–µ—Ä–∏–∞–ª—ã.cs
internal class –ú–∞—Ç–µ—Ä–∏–∞–ª—ã
{
    public int Id { get; set; }
    public string –ù–∞–∑–≤–∞–Ω–∏–µ { get; set; }
    public List<–ú–µ–±–µ–ª—å> –ú–µ–±–µ–ª–∏ { get; set; } = new();
}

// Models/–§–∞—Å–æ–Ω.cs
internal class –§–∞—Å–æ–Ω
{
    public int Id { get; set; }
    public string? –ù–∞–∑–≤–∞–Ω–∏–µ { get; set; }
    public List<–ú–µ–±–µ–ª—å> –ú–µ–±–µ–ª–∏ { get; set; } = new();
}

// Models/–¶–µ—Ö–∞.cs
internal class –¶–µ—Ö–∞
{
    public int Id { get; set; }
    public string? –ù–∞–∑–≤–∞–Ω–∏–µ { get; set; }
}

// Models/–ú–µ–±–µ–ª—å.cs
internal class –ú–µ–±–µ–ª—å
{
    public int Id { get; set; }
    public string? –ù–∞–∑–≤–∞–Ω–∏–µ { get; set; }
    public int –§–∞—Å–æ–ΩId { get; set; }
    public –§–∞—Å–æ–Ω –§–∞—Å–æ–Ω { get; set; }
    public int –ú–∞—Ç–µ—Ä–∏–∞–ª—ãId { get; set; }
    public –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –ú–∞—Ç–µ—Ä–∏–∞–ª—ã { get; set; }
    public List<–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞> –í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞s { get; set; }
}

// Models/–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞.cs
internal class –í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
{
    public int Id { get; set; }
    public string? Name { get; set; }
    public int –ú–µ–±–µ–ª—åId { get; set; }
    public –ú–µ–±–µ–ª—å –ú–µ–±–µ–ª—å { get; set; }
    public int –¶–µ—Ö–∞Id { get; set; }
    public –¶–µ—Ö–∞ –¶–µ—Ö–∞ { get; set; }
    public int? –í—Ä–µ–º—è { get; set; }
}

üìÅ DbContext –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î
================================================================================
// Data/AppDbContext.cs
using Microsoft.EntityFrameworkCore;

public class AppDbContext : DbContext
{
    public DbSet<–ú–∞—Ç–µ—Ä–∏–∞–ª—ã> –ú–∞—Ç–µ—Ä–∏–∞–ª—ã { get; set; }
    public DbSet<–§–∞—Å–æ–Ω> –§–∞—Å–æ–Ω—ã { get; set; }
    public DbSet<–¶–µ—Ö–∞> –¶–µ—Ö–∏ { get; set; }
    public DbSet<–ú–µ–±–µ–ª—å> –ú–µ–±–µ–ª–∏ { get; set; }
    public DbSet<–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞> –í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ { get; set; }

    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
        optionsBuilder.UseSqlite("Data Source=mebel.db");
    }

    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        modelBuilder.Entity<–ú–µ–±–µ–ª—å>()
            .HasOne(m => m.–§–∞—Å–æ–Ω)
            .WithMany(f => f.–ú–µ–±–µ–ª–∏)
            .HasForeignKey(m => m.–§–∞—Å–æ–ΩId);

        modelBuilder.Entity<–ú–µ–±–µ–ª—å>()
            .HasOne(m => m.–ú–∞—Ç–µ—Ä–∏–∞–ª—ã)
            .WithMany(mt => mt.–ú–µ–±–µ–ª–∏)
            .HasForeignKey(m => m.–ú–∞—Ç–µ—Ä–∏–∞–ª—ãId);

        modelBuilder.Entity<–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞>()
            .HasOne(vp => vp.–ú–µ–±–µ–ª—å)
            .WithMany(m => m.–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞s)
            .HasForeignKey(vp => vp.–ú–µ–±–µ–ª—åId);

        modelBuilder.Entity<–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞>()
            .HasOne(vp => vp.–¶–µ—Ö–∞)
            .WithMany()
            .HasForeignKey(vp => vp.–¶–µ—Ö–∞Id);
    }
}

üìÅ –ì–ª–∞–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ - —Å–ø–∏—Å–æ–∫ –º–µ–±–µ–ª–∏
================================================================================
// Forms/MainForm.cs
// –ö–æ–¥ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –º–µ–±–µ–ª–∏, –∫–Ω–æ–ø–æ–∫ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —Ñ–æ—Ä–º–∞–º–∏

üìÅ –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–±–µ–ª–∏
================================================================================
// Forms/FurnitureForm.cs
// –§–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –º–µ–±–µ–ª–∏

üìÅ –§–æ—Ä–º–∞ —Å–ø–∏—Å–∫–∞ —Ü–µ—Ö–æ–≤
================================================================================
// Forms/WorkshopsForm.cs
// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ü–µ—Ö–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –º–µ–±–µ–ª—å—é —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞

üìÅ –§–æ—Ä–º–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∏ —Ä–∞—Å—á–µ—Ç–∞ —Å—É–º–º–∞—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
================================================================================
// Forms/ProductionTimeForm.cs
// –ü–æ–¥—Å—á–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–¥–µ–ª–∏—è

üìÅ –ò—Å–∫–ª—é—á–µ–Ω–∏—è, –≤–æ–∑–≤—Ä–∞—Ç –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
================================================================================
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥", –≤–æ–∑–≤—Ä–∞—Ç –º–µ–∂–¥—É —Ñ–æ—Ä–º–∞–º–∏, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

üìÅ –ì–ª–∞–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ - —Å–ø–∏—Å–æ–∫ –º–µ–±–µ–ª–∏
================================================================================
// Forms/MainForm.cs
using System;
using System.Linq;
using System.Windows.Forms;

public class MainForm : Form
{
    private DataGridView dgvMebel;
    private Button btnAdd, btnEdit, btnWorkshops, btnProductionTime;

    public MainForm()
    {
        Text = "–°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ü–∏–∏";
        Width = 800;
        Height = 600;

        dgvMebel = new DataGridView { Dock = DockStyle.Top, Height = 400, ReadOnly = true, AutoGenerateColumns = true };
        btnAdd = new Button { Text = "–î–æ–±–∞–≤–∏—Ç—å", Left = 10, Top = 420, Width = 100 };
        btnEdit = new Button { Text = "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å", Left = 120, Top = 420, Width = 100 };
        btnWorkshops = new Button { Text = "–¶–µ—Ö–∞", Left = 230, Top = 420, Width = 100 };
        btnProductionTime = new Button { Text = "–í—Ä–µ–º—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞", Left = 340, Top = 420, Width = 160 };

        Controls.Add(dgvMebel);
        Controls.Add(btnAdd);
        Controls.Add(btnEdit);
        Controls.Add(btnWorkshops);
        Controls.Add(btnProductionTime);

        Load += MainForm_Load;
        btnAdd.Click += (s, e) => new FurnitureForm().ShowDialog();
        btnEdit.Click += (s, e) => {
            if (dgvMebel.CurrentRow?.DataBoundItem is –ú–µ–±–µ–ª—å selected)
                new FurnitureForm(selected.Id).ShowDialog();
        };
        btnWorkshops.Click += (s, e) => new WorkshopsForm().ShowDialog();
        btnProductionTime.Click += (s, e) => new ProductionTimeForm().ShowDialog();
    }

    private void MainForm_Load(object sender, EventArgs e)
    {
        using var db = new AppDbContext();
        dgvMebel.DataSource = db.–ú–µ–±–µ–ª–∏
            .Select(m => new { m.Id, m.–ù–∞–∑–≤–∞–Ω–∏–µ, –ú–∞—Ç–µ—Ä–∏–∞–ª = m.–ú–∞—Ç–µ—Ä–∏–∞–ª—ã.–ù–∞–∑–≤–∞–Ω–∏–µ, –§–∞—Å–æ–Ω = m.–§–∞—Å–æ–Ω.–ù–∞–∑–≤–∞–Ω–∏–µ })
            .ToList();
    }
}

üìÅ –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–±–µ–ª–∏
================================================================================
// Forms/FurnitureForm.cs
using System;
using System.Linq;
using System.Windows.Forms;

public class FurnitureForm : Form
{
    private ComboBox cbMaterials, cbFason;
    private TextBox tbName;
    private Button btnSave;
    private int? furnitureId;

    public FurnitureForm(int? id = null)
    {
        furnitureId = id;
        Text = id == null ? "–î–æ–±–∞–≤–∏—Ç—å –º–µ–±–µ–ª—å" : "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ–±–µ–ª—å";
        Width = 400;
        Height = 250;

        Label lblName = new Label { Text = "–ù–∞–∑–≤–∞–Ω–∏–µ:", Left = 10, Top = 20 };
        tbName = new TextBox { Left = 100, Top = 20, Width = 250 };

        Label lblMaterial = new Label { Text = "–ú–∞—Ç–µ—Ä–∏–∞–ª:", Left = 10, Top = 60 };
        cbMaterials = new ComboBox { Left = 100, Top = 60, Width = 250 };

        Label lblFason = new Label { Text = "–§–∞—Å–æ–Ω:", Left = 10, Top = 100 };
        cbFason = new ComboBox { Left = 100, Top = 100, Width = 250 };

        btnSave = new Button { Text = "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", Left = 150, Top = 150, Width = 100 };

        Controls.AddRange(new Control[] { lblName, tbName, lblMaterial, cbMaterials, lblFason, cbFason, btnSave });

        Load += FurnitureForm_Load;
        btnSave.Click += BtnSave_Click;
    }

    private void FurnitureForm_Load(object sender, EventArgs e)
    {
        using var db = new AppDbContext();
        cbMaterials.DataSource = db.–ú–∞—Ç–µ—Ä–∏–∞–ª—ã.ToList();
        cbMaterials.DisplayMember = "–ù–∞–∑–≤–∞–Ω–∏–µ";
        cbMaterials.ValueMember = "Id";

        cbFason.DataSource = db.–§–∞—Å–æ–Ω—ã.ToList();
        cbFason.DisplayMember = "–ù–∞–∑–≤–∞–Ω–∏–µ";
        cbFason.ValueMember = "Id";

        if (furnitureId != null)
        {
            var item = db.–ú–µ–±–µ–ª–∏.Find(furnitureId);
            tbName.Text = item.–ù–∞–∑–≤–∞–Ω–∏–µ;
            cbMaterials.SelectedValue = item.–ú–∞—Ç–µ—Ä–∏–∞–ª—ãId;
            cbFason.SelectedValue = item.–§–∞—Å–æ–ΩId;
        }
    }

    private void BtnSave_Click(object sender, EventArgs e)
    {
        using var db = new AppDbContext();
        –ú–µ–±–µ–ª—å item = furnitureId == null ? new –ú–µ–±–µ–ª—å() : db.–ú–µ–±–µ–ª–∏.Find(furnitureId);
        item.–ù–∞–∑–≤–∞–Ω–∏–µ = tbName.Text;
        item.–ú–∞—Ç–µ—Ä–∏–∞–ª—ãId = (int)cbMaterials.SelectedValue;
        item.–§–∞—Å–æ–ΩId = (int)cbFason.SelectedValue;

        if (furnitureId == null)
            db.–ú–µ–±–µ–ª–∏.Add(item);

        db.SaveChanges();
        Close();
    }
}

üìÅ –§–æ—Ä–º–∞ —Å–ø–∏—Å–∫–∞ —Ü–µ—Ö–æ–≤
================================================================================
// Forms/WorkshopsForm.cs
using System.Linq;
using System.Windows.Forms;

public class WorkshopsForm : Form
{
    private DataGridView dgv;

    public WorkshopsForm()
    {
        Text = "–°–ø–∏—Å–æ–∫ —Ü–µ—Ö–æ–≤";
        Width = 500;
        Height = 400;
        dgv = new DataGridView { Dock = DockStyle.Fill, ReadOnly = true, AutoGenerateColumns = true };
        Controls.Add(dgv);

        Load += (s, e) =>
        {
            using var db = new AppDbContext();
            dgv.DataSource = db.–¶–µ—Ö–∏.ToList();
        };
    }
}

üìÅ –§–æ—Ä–º–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∏ —Ä–∞—Å—á–µ—Ç–∞ —Å—É–º–º–∞—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
================================================================================
// Forms/ProductionTimeForm.cs
using System.Linq;
using System.Windows.Forms;

public class ProductionTimeForm : Form
{
    private DataGridView dgv;

    public ProductionTimeForm()
    {
        Text = "–û–±—â–µ–µ –≤—Ä–µ–º—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –ø–æ –º–µ–±–µ–ª–∏";
        Width = 600;
        Height = 400;
        dgv = new DataGridView { Dock = DockStyle.Fill, ReadOnly = true, AutoGenerateColumns = true };
        Controls.Add(dgv);

        Load += (s, e) =>
        {
            using var db = new AppDbContext();
            dgv.DataSource = db.–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
                .GroupBy(vp => vp.–ú–µ–±–µ–ª—å.–ù–∞–∑–≤–∞–Ω–∏–µ)
                .Select(g => new { –ù–∞–∑–≤–∞–Ω–∏–µ = g.Key, –û–±—â–µ–µ–í—Ä–µ–º—è = g.Sum(x => x.–í—Ä–µ–º—è ?? 0) })
                .ToList();
        };
    }
}

üìÅ –ì–ª–∞–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ - —Å–ø–∏—Å–æ–∫ –º–µ–±–µ–ª–∏ (Form1.cs)
================================================================================
// Form1.cs
using Microsoft.EntityFrameworkCore;
using System;
using System.Linq;
using System.Windows.Forms;
using –§–∞–±—Ä–∏—Ü–∞–ú–µ–±–µ–ª–∏.–î–∞—Ç–∞;

namespace –§–∞–±—Ä–∏—Ü–∞–ú–µ–±–µ–ª–∏
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            LoadDB();
        }

        private void LoadDB()
        {
            using (var context = new AppDbContext())
            {
                var –ú–µ–±–µ–ª—å–°–î–µ—Ç–∞–ª—è–º–∏ = context.–ú–µ–±–µ–ª—å
                    .Include(m => m.–§–∞—Å–æ–Ω)
                    .Include(m => m.–ú–∞—Ç–µ—Ä–∏–∞–ª—ã)
                    .Include(m => m.–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞s).ThenInclude(v => v.–¶–µ—Ö–∞)
                    .ToList();

                var –¥–∞–Ω–Ω—ã–µ = –ú–µ–±–µ–ª—å–°–î–µ—Ç–∞–ª—è–º–∏.Select(m => new
                {
                    Id = m.Id,
                    –ù–∞–∑–≤–∞–Ω–∏–µ = m.–ù–∞–∑–≤–∞–Ω–∏–µ,
                    –§–∞—Å–æ–Ω = m.–§–∞—Å–æ–Ω.–ù–∞–∑–≤–∞–Ω–∏–µ,
                    –ú–∞—Ç–µ—Ä–∏–∞–ª = m.–ú–∞—Ç–µ—Ä–∏–∞–ª—ã.–ù–∞–∑–≤–∞–Ω–∏–µ,
                    –í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ = m.–í—Ä–µ–º—è–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞s.Sum(v => v.–í—Ä–µ–º—è ?? 0)
                }).ToList();

                dataGridView1.DataSource = –¥–∞–Ω–Ω—ã–µ;
            }
        }

        private void buttonAdd_Click(object sender, EventArgs e)
        {
            var form = new Form2();
            if (form.ShowDialog() == DialogResult.OK)
                LoadDB();
        }

        private void buttonEdit_Click(object sender, EventArgs e)
        {
            if (dataGridView1.CurrentRow == null) return;

            int id = (int)dataGridView1.CurrentRow.Cells["Id"].Value;
            var form = new Form2(id);
            if (form.ShowDialog() == DialogResult.OK)
                LoadDB();
        }

        private void buttonWorkshops_Click(object sender, EventArgs e)
        {
            new WorkshopsForm().ShowDialog();
        }

        private void buttonTimeSummary_Click(object sender, EventArgs e)
        {
            new ProductionTimeForm().ShowDialog();
        }
    }
}

üìÅ –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–±–µ–ª–∏ (Form2.cs)
================================================================================
// Form2.cs
using System;
using System.Linq;
using System.Windows.Forms;
using –§–∞–±—Ä–∏—Ü–∞–ú–µ–±–µ–ª–∏.–î–∞—Ç–∞;

namespace –§–∞–±—Ä–∏—Ü–∞–ú–µ–±–µ–ª–∏
{
    public partial class Form2 : Form
    {
        private int? furnitureId;

        public Form2(int? id = null)
        {
            InitializeComponent();
            furnitureId = id;
        }

        private void Form2_Load(object sender, EventArgs e)
        {
            using var db = new AppDbContext();

            comboBoxMaterial.DataSource = db.–ú–∞—Ç–µ—Ä–∏–∞–ª—ã.ToList();
            comboBoxMaterial.DisplayMember = "–ù–∞–∑–≤–∞–Ω–∏–µ";
            comboBoxMaterial.ValueMember = "Id";

            comboBoxFason.DataSource = db.–§–∞—Å–æ–Ω—ã.ToList();
            comboBoxFason.DisplayMember = "–ù–∞–∑–≤–∞–Ω–∏–µ";
            comboBoxFason.ValueMember = "Id";

            if (furnitureId != null)
            {
                var –º–µ–±–µ–ª—å = db.–ú–µ–±–µ–ª—å.Find(furnitureId);
                textBoxName.Text = –º–µ–±–µ–ª—å.–ù–∞–∑–≤–∞–Ω–∏–µ;
                comboBoxMaterial.SelectedValue = –º–µ–±–µ–ª—å.–ú–∞—Ç–µ—Ä–∏–∞–ª—ãId;
                comboBoxFason.SelectedValue = –º–µ–±–µ–ª—å.–§–∞—Å–æ–ΩId;
            }
        }

        private void buttonSave_Click(object sender, EventArgs e)
        {
            using var db = new AppDbContext();
            –ú–µ–±–µ–ª—å –º–µ–±–µ–ª—å = furnitureId == null ? new –ú–µ–±–µ–ª—å() : db.–ú–µ–±–µ–ª—å.Find(furnitureId);

            –º–µ–±–µ–ª—å.–ù–∞–∑–≤–∞–Ω–∏–µ = textBoxName.Text;
            –º–µ–±–µ–ª—å.–ú–∞—Ç–µ—Ä–∏–∞–ª—ãId = (int)comboBoxMaterial.SelectedValue;
            –º–µ–±–µ–ª—å.–§–∞—Å–æ–ΩId = (int)comboBoxFason.SelectedValue;

            if (furnitureId == null)
                db.–ú–µ–±–µ–ª—å.Add(–º–µ–±–µ–ª—å);

            db.SaveChanges();
            DialogResult = DialogResult.OK;
            Close();
        }
    }
}

